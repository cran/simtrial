<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yujie Zhao and Keaven Anderson" />


<title>Custom Fixed Design Simulations: A Tutorial on Writing Code from the Ground Up</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Custom Fixed Design Simulations: A Tutorial
on Writing Code from the Ground Up</h1>
<h4 class="author">Yujie Zhao and Keaven Anderson</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(gsDesign2)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(simtrial)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(doFuture)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span></code></pre></div>
<p>The vignette <a href="https://merck.github.io/simtrial/articles/sim_fixed_design_simple.html">Simulate
Fixed Designs with Ease via sim_fixed_n</a> presents fixed design
simulations using a single function call, <code>sim_fixed_n()</code>. It
offers a simple and straightforward process for running simulations
quickly.</p>
<p>If users are interested in the following aspects, we recommend
simulating from scratch rather than directly using
<code>sim_fixed_n()</code>:</p>
<ul>
<li>Tests beyond the logrank test or Fleming-Harrington weighted logrank
tests, such as modestly weighted logrank tests, RMST tests, and
milestone tests.</li>
<li>More complex cutoffs, such as analyzing data after 12 months of
follow-up when at least 80% of the patient population is enrolled.</li>
<li>Different dropout rates in the control and experimental groups.</li>
</ul>
<p>The process for simulating from scratch is outlined in Steps 1 to 5
below.</p>
<div id="step-1-simulate-time-to-event-data" class="section level1">
<h1>Step 1: Simulate time-to-event data</h1>
<p>The <code>sim_pw_surv()</code> function allows for the simulation of
a clinical trial with essentially arbitrary patterns of enrollment,
failure rates, and censoring. To implement <code>sim_pw_surv()</code>,
you need to specify 5 design characteristics to simulate time-to-event
data:</p>
<ol style="list-style-type: decimal">
<li>Sample Size (input as <code>n</code>).</li>
<li>Stratified or Non-Stratified Designs (input as
<code>stratum</code>).</li>
<li>Randomization Ratio (input as <code>block</code>). The
<code>sim_pw_surv()</code> function uses fixed block randomization.</li>
<li>Enrollment Rate (input as <code>enroll_rate</code>). The
<code>sim_pw_surv()</code> function supports piecewise enrollment,
allowing the enrollment rate to be piecewise constant.</li>
<li>Failure Rate (input as <code>fail_rate</code>) or time-to-event
rate. The <code>sim_pw_surv()</code> function uses a piecewise
exponential distribution for the failure rate, which makes it easy to
define a distribution with changing failure rates over time.
Specifically, in the <span class="math inline">\(j\)</span>-th interval,
the rate is denoted as <span class="math inline">\(\lambda_j \geq
0\)</span>. We require that at least one interval has <span class="math inline">\(\lambda_j &gt; 0\)</span>. There are two methods
for defining the failure rate:</li>
</ol>
<ul>
<li>Specify the failure rate by treatment group, stratum, and time
period. An example can be found in Scenario b).</li>
<li>Create a <code>fail_rate</code> using
<code>gsDesign2::define_fail_rate</code>, and then convert it to the
required format using <code>to_sim_pw_surv()</code>. An example is
provided in Scenario a).</li>
</ul>
<ol style="list-style-type: decimal">
<li>Dropout Rate (input as <code>dropout_Rate</code>). The
<code>sim_pw_surv()</code> function accepts piecewise constant dropout
rates, which may vary by treatment group. The configuration for dropout
should be specified by treatment group, stratum, and time period, and
setting up the dropout rate follows the same approach as the failure
rate.</li>
</ol>
<div id="scenario-a-the-simplest-scenario" class="section level2">
<h2>Scenario a) The simplest scenario</h2>
<p>We begin with the simplest implementation of
<code>sim_pw_surv()</code>. The following lines of code will generate
500 subjects using equal randomization and an unstratified design.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>stratum <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">stratum =</span> <span class="st">&quot;All&quot;</span>, <span class="at">p =</span> <span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>block <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;experimental&quot;</span>, <span class="st">&quot;control&quot;</span>), <span class="dv">2</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>enroll_rate <span class="ot">&lt;-</span> <span class="fu">define_enroll_rate</span>(<span class="at">rate =</span> <span class="dv">12</span>, <span class="at">duration =</span> n <span class="sc">/</span> <span class="dv">12</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>fail_rate <span class="ot">&lt;-</span> <span class="fu">define_fail_rate</span>(<span class="at">duration =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="cn">Inf</span>), <span class="at">fail_rate =</span> <span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">/</span> <span class="dv">10</span>, </span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>                              <span class="at">hr =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.7</span>), <span class="at">dropout_rate =</span> <span class="fl">0.0001</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>uncut_data_a <span class="ot">&lt;-</span> <span class="fu">sim_pw_surv</span>(<span class="at">n =</span> n, <span class="at">stratum =</span> stratum, <span class="at">block =</span> block,</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>                            <span class="at">enroll_rate =</span> enroll_rate,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>                            <span class="at">fail_rate =</span> <span class="fu">to_sim_pw_surv</span>(fail_rate)<span class="sc">$</span>fail_rate,</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>                            <span class="at">dropout_rate =</span> <span class="fu">to_sim_pw_surv</span>(fail_rate)<span class="sc">$</span>dropout_rate)</span></code></pre></div>
<p>The output of <code>sim_pw_surv()</code> is subject-level
observations, including stratum, enrollment time for the observation,
treatment group the observation is randomized to, failure time, dropout
time, calendar time of enrollment plot the minimum of failure time and
dropout time ( <code>cte</code>), and an failure and dropout indicator
(<code>fail = 1</code> is a failure, <code>fail = 0</code> is a
dropout).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>uncut_data_a <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="sc">|&gt;</span> <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">tab_header</span>(<span class="st">&quot;An Overview of Simulated TTE data&quot;</span>)</span></code></pre></div>
<div id="zrpbygbvkx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zrpbygbvkx table {
font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
}
#zrpbygbvkx thead, #zrpbygbvkx tbody, #zrpbygbvkx tfoot, #zrpbygbvkx tr, #zrpbygbvkx td, #zrpbygbvkx th {
border-style: none;
}
#zrpbygbvkx p {
margin: 0;
padding: 0;
}
#zrpbygbvkx .gt_table {
display: table;
border-collapse: collapse;
line-height: normal;
margin-left: auto;
margin-right: auto;
color: #333333;
font-size: 16px;
font-weight: normal;
font-style: normal;
background-color: #FFFFFF;
width: auto;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #A8A8A8;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #A8A8A8;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
}
#zrpbygbvkx .gt_caption {
padding-top: 4px;
padding-bottom: 4px;
}
#zrpbygbvkx .gt_title {
color: #333333;
font-size: 125%;
font-weight: initial;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
border-bottom-color: #FFFFFF;
border-bottom-width: 0;
}
#zrpbygbvkx .gt_subtitle {
color: #333333;
font-size: 85%;
font-weight: initial;
padding-top: 3px;
padding-bottom: 5px;
padding-left: 5px;
padding-right: 5px;
border-top-color: #FFFFFF;
border-top-width: 0;
}
#zrpbygbvkx .gt_heading {
background-color: #FFFFFF;
text-align: center;
border-bottom-color: #FFFFFF;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
}
#zrpbygbvkx .gt_bottom_border {
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#zrpbygbvkx .gt_col_headings {
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
}
#zrpbygbvkx .gt_col_heading {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: normal;
text-transform: inherit;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: bottom;
padding-top: 5px;
padding-bottom: 6px;
padding-left: 5px;
padding-right: 5px;
overflow-x: hidden;
}
#zrpbygbvkx .gt_column_spanner_outer {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: normal;
text-transform: inherit;
padding-top: 0;
padding-bottom: 0;
padding-left: 4px;
padding-right: 4px;
}
#zrpbygbvkx .gt_column_spanner_outer:first-child {
padding-left: 0;
}
#zrpbygbvkx .gt_column_spanner_outer:last-child {
padding-right: 0;
}
#zrpbygbvkx .gt_column_spanner {
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
vertical-align: bottom;
padding-top: 5px;
padding-bottom: 5px;
overflow-x: hidden;
display: inline-block;
width: 100%;
}
#zrpbygbvkx .gt_spanner_row {
border-bottom-style: hidden;
}
#zrpbygbvkx .gt_group_heading {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: middle;
text-align: left;
}
#zrpbygbvkx .gt_empty_group_heading {
padding: 0.5px;
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
vertical-align: middle;
}
#zrpbygbvkx .gt_from_md > :first-child {
margin-top: 0;
}
#zrpbygbvkx .gt_from_md > :last-child {
margin-bottom: 0;
}
#zrpbygbvkx .gt_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
margin: 10px;
border-top-style: solid;
border-top-width: 1px;
border-top-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: middle;
overflow-x: hidden;
}
#zrpbygbvkx .gt_stub {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-right-style: solid;
border-right-width: 2px;
border-right-color: #D3D3D3;
padding-left: 5px;
padding-right: 5px;
}
#zrpbygbvkx .gt_stub_row_group {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-right-style: solid;
border-right-width: 2px;
border-right-color: #D3D3D3;
padding-left: 5px;
padding-right: 5px;
vertical-align: top;
}
#zrpbygbvkx .gt_row_group_first td {
border-top-width: 2px;
}
#zrpbygbvkx .gt_row_group_first th {
border-top-width: 2px;
}
#zrpbygbvkx .gt_summary_row {
color: #333333;
background-color: #FFFFFF;
text-transform: inherit;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
}
#zrpbygbvkx .gt_first_summary_row {
border-top-style: solid;
border-top-color: #D3D3D3;
}
#zrpbygbvkx .gt_first_summary_row.thick {
border-top-width: 2px;
}
#zrpbygbvkx .gt_last_summary_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#zrpbygbvkx .gt_grand_summary_row {
color: #333333;
background-color: #FFFFFF;
text-transform: inherit;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
}
#zrpbygbvkx .gt_first_grand_summary_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-top-style: double;
border-top-width: 6px;
border-top-color: #D3D3D3;
}
#zrpbygbvkx .gt_last_grand_summary_row_top {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-bottom-style: double;
border-bottom-width: 6px;
border-bottom-color: #D3D3D3;
}
#zrpbygbvkx .gt_striped {
background-color: rgba(128, 128, 128, 0.05);
}
#zrpbygbvkx .gt_table_body {
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#zrpbygbvkx .gt_footnotes {
color: #333333;
background-color: #FFFFFF;
border-bottom-style: none;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
}
#zrpbygbvkx .gt_footnote {
margin: 0px;
font-size: 90%;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
}
#zrpbygbvkx .gt_sourcenotes {
color: #333333;
background-color: #FFFFFF;
border-bottom-style: none;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
}
#zrpbygbvkx .gt_sourcenote {
font-size: 90%;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
}
#zrpbygbvkx .gt_left {
text-align: left;
}
#zrpbygbvkx .gt_center {
text-align: center;
}
#zrpbygbvkx .gt_right {
text-align: right;
font-variant-numeric: tabular-nums;
}
#zrpbygbvkx .gt_font_normal {
font-weight: normal;
}
#zrpbygbvkx .gt_font_bold {
font-weight: bold;
}
#zrpbygbvkx .gt_font_italic {
font-style: italic;
}
#zrpbygbvkx .gt_super {
font-size: 65%;
}
#zrpbygbvkx .gt_footnote_marks {
font-size: 75%;
vertical-align: 0.4em;
position: initial;
}
#zrpbygbvkx .gt_asterisk {
font-size: 100%;
vertical-align: 0;
}
#zrpbygbvkx .gt_indent_1 {
text-indent: 5px;
}
#zrpbygbvkx .gt_indent_2 {
text-indent: 10px;
}
#zrpbygbvkx .gt_indent_3 {
text-indent: 15px;
}
#zrpbygbvkx .gt_indent_4 {
text-indent: 20px;
}
#zrpbygbvkx .gt_indent_5 {
text-indent: 25px;
}
#zrpbygbvkx .katex-display {
display: inline-flex !important;
margin-bottom: 0.75em !important;
}
#zrpbygbvkx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>An Overview of Simulated TTE data</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="stratum">stratum</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="enroll_time">enroll_time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="treatment">treatment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="fail_time">fail_time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="dropout_time">dropout_time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cte">cte</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="fail">fail</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="stratum" class="gt_row gt_left">All</td>
<td headers="enroll_time" class="gt_row gt_right">0.04250966</td>
<td headers="treatment" class="gt_row gt_left">experimental</td>
<td headers="fail_time" class="gt_row gt_right">1.1694497</td>
<td headers="dropout_time" class="gt_row gt_right">6265.622</td>
<td headers="cte" class="gt_row gt_right">1.2119594</td>
<td headers="fail" class="gt_row gt_right">1</td></tr>
    <tr><td headers="stratum" class="gt_row gt_left">All</td>
<td headers="enroll_time" class="gt_row gt_right">0.15597253</td>
<td headers="treatment" class="gt_row gt_left">control</td>
<td headers="fail_time" class="gt_row gt_right">73.5774306</td>
<td headers="dropout_time" class="gt_row gt_right">21706.085</td>
<td headers="cte" class="gt_row gt_right">73.7334032</td>
<td headers="fail" class="gt_row gt_right">1</td></tr>
    <tr><td headers="stratum" class="gt_row gt_left">All</td>
<td headers="enroll_time" class="gt_row gt_right">0.19363998</td>
<td headers="treatment" class="gt_row gt_left">experimental</td>
<td headers="fail_time" class="gt_row gt_right">15.1356774</td>
<td headers="dropout_time" class="gt_row gt_right">18096.246</td>
<td headers="cte" class="gt_row gt_right">15.3293174</td>
<td headers="fail" class="gt_row gt_right">1</td></tr>
    <tr><td headers="stratum" class="gt_row gt_left">All</td>
<td headers="enroll_time" class="gt_row gt_right">0.23882703</td>
<td headers="treatment" class="gt_row gt_left">control</td>
<td headers="fail_time" class="gt_row gt_right">1.9020241</td>
<td headers="dropout_time" class="gt_row gt_right">20844.870</td>
<td headers="cte" class="gt_row gt_right">2.1408512</td>
<td headers="fail" class="gt_row gt_right">1</td></tr>
    <tr><td headers="stratum" class="gt_row gt_left">All</td>
<td headers="enroll_time" class="gt_row gt_right">0.27283752</td>
<td headers="treatment" class="gt_row gt_left">control</td>
<td headers="fail_time" class="gt_row gt_right">2.9475061</td>
<td headers="dropout_time" class="gt_row gt_right">11058.946</td>
<td headers="cte" class="gt_row gt_right">3.2203437</td>
<td headers="fail" class="gt_row gt_right">1</td></tr>
    <tr><td headers="stratum" class="gt_row gt_left">All</td>
<td headers="enroll_time" class="gt_row gt_right">0.29362231</td>
<td headers="treatment" class="gt_row gt_left">experimental</td>
<td headers="fail_time" class="gt_row gt_right">0.5490203</td>
<td headers="dropout_time" class="gt_row gt_right">7004.398</td>
<td headers="cte" class="gt_row gt_right">0.8426426</td>
<td headers="fail" class="gt_row gt_right">1</td></tr>
  </tbody>
  
</table>
</div>
</div>
<div id="scenario-b-differential-dropout-rates" class="section level2">
<h2>Scenario b) Differential dropout rates</h2>
<p>The dropout rate can differ between groups. For instance, in
open-label studies, the control group may experience a higher dropout
rate. The follow lines of code assumes the control group has a dropout
rate of 0.002 for the first 10 months, which then decreases to 0.001
thereafter. In contrast, the experimental group has a constant dropout
rate of 0.001 throughout the study.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>differential_dropout_rate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">stratum =</span> <span class="fu">rep</span>(<span class="st">&quot;All&quot;</span>, <span class="dv">3</span>), </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">period =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;experimental&quot;</span>), </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">duration =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>), </span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">rate =</span> <span class="fu">c</span>(<span class="fl">0.002</span>, <span class="fl">0.001</span>, <span class="fl">0.001</span>))</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>uncut_data_b <span class="ot">&lt;-</span> <span class="fu">sim_pw_surv</span>(<span class="at">n =</span> n, <span class="at">stratum =</span> stratum, <span class="at">block =</span> block,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>                            <span class="at">enroll_rate =</span> enroll_rate,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>                            <span class="at">fail_rate =</span> <span class="fu">to_sim_pw_surv</span>(fail_rate)<span class="sc">$</span>fail_rate,</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>                            <span class="at">dropout_rate =</span> differential_dropout_rate)</span></code></pre></div>
</div>
<div id="scenario-c-stratified-designs" class="section level2">
<h2>Scenario c) Stratified designs</h2>
<p>The following code assumes there are two strata (biomarker-positive
and biomarker-negative) with equal prevalence of 0.5 for each. In the
control arm, the median survival time is 10 months for
biomarker-positive subjects and 8 months for biomarker-negative
subjects. For both strata, the hazard ratio is 1 for the first 3 months,
after which it decreases to 0.6 for biomarker-positive subjects and 0.8
for biomarker-negative subjects. The dropout rate is contently 0.001 for
both strata over time.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>stratified_enroll_rate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="at">stratum =</span> <span class="fu">c</span>(<span class="st">&quot;Biomarker positive&quot;</span>, <span class="st">&quot;Biomarker negative&quot;</span>),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">rate =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">12</span>), </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">duration =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>stratified_fail_rate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="at">stratum =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Biomarker positive&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;Biomarker negative&quot;</span>, <span class="dv">3</span>)), </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="at">period =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;experimental&quot;</span>, <span class="st">&quot;experimental&quot;</span>), <span class="dv">2</span>),</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="at">duration =</span> <span class="fu">c</span>(<span class="cn">Inf</span>, <span class="dv">3</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="dv">3</span>, <span class="cn">Inf</span>), </span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="at">rate =</span> <span class="fu">c</span>(<span class="co"># failure rate of biomarker positive subjects: control arm, exp arm period 1, exp arm period 2</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>           <span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">/</span> <span class="dv">10</span>, <span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">/</span><span class="dv">10</span>, <span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">/</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fl">0.6</span>,</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>           <span class="co"># failure rate of biomarker negative subjects: control arm, exp arm period 1, exp arm period 2</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>           <span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">/</span> <span class="dv">8</span>, <span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">/</span><span class="dv">8</span>, <span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">/</span> <span class="dv">8</span> <span class="sc">*</span> <span class="fl">0.8</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  )</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>stratified_dropout_rate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  <span class="at">stratum =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Biomarker positive&quot;</span>, <span class="st">&quot;Biomarker negative&quot;</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>  <span class="at">period =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;experimental&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;experimental&quot;</span>),</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>  <span class="at">duration =</span> <span class="fu">rep</span>(<span class="cn">Inf</span>, <span class="dv">4</span>), </span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>  <span class="at">rate =</span> <span class="fu">rep</span>(<span class="fl">0.001</span>, <span class="dv">4</span>)</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>  )</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>uncut_data_c <span class="ot">&lt;-</span> <span class="fu">sim_pw_surv</span>(<span class="at">n =</span> n,</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>                            <span class="at">stratum =</span> <span class="fu">data.frame</span>(<span class="at">stratum =</span> <span class="fu">c</span>(<span class="st">&quot;Biomarker positive&quot;</span>, <span class="st">&quot;Biomarker negative&quot;</span>), </span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>                                                 <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)),</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>                            <span class="at">block =</span> block,</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>                            <span class="at">enroll_rate =</span> stratified_enroll_rate,</span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>                            <span class="at">fail_rate =</span> stratified_fail_rate,</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>                            <span class="at">dropout_rate =</span> stratified_dropout_rate</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>                            )</span></code></pre></div>
</div>
<div id="scenario-d-multi-arm-designs" class="section level2">
<h2>Scenario d) Multi-arm designs</h2>
<p>Suppose you wish to have 3 arms: control, low-dose and high-dose. The
following code assumes the control arm has a median survival time of 10
months, the low-dose arm has a median survival time of 12 months, and
the high-dose arm has a median survival time of 14 months. The hazard
ratio for the low-dose arm is 0.8, and the hazard ratio for the
high-dose arm is 0.6. The dropout rate is 0.001 for all arms. Block size
is 7 with 3:2:2 randomization.</p>
<p>We begin by setting up enrollment, failure and dropout rates.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>enroll_rate <span class="ot">&lt;-</span> <span class="fu">define_enroll_rate</span>(<span class="at">rate =</span> <span class="dv">12</span>, <span class="at">duration =</span> n <span class="sc">/</span> <span class="dv">12</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>three_arm_fail_rate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">stratum =</span> <span class="st">&quot;All&quot;</span>,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="at">period =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;low-dose&quot;</span>, <span class="st">&quot;low-dose&quot;</span>, <span class="st">&quot;high-dose&quot;</span>, <span class="st">&quot;high-dose&quot;</span>),</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="at">duration =</span> <span class="fu">c</span>(<span class="cn">Inf</span>, <span class="dv">3</span>, <span class="cn">Inf</span>, <span class="dv">3</span>, <span class="cn">Inf</span>), </span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="at">rate =</span> <span class="fu">c</span>(<span class="co"># failure rate of control arm: period 1, period 2</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>           <span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">/</span> <span class="dv">10</span>,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>           <span class="co"># failure rate of low-dose arm: period 1, period 2</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>           <span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">/</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span> <span class="sc">/</span> .<span class="dv">8</span>),</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>           <span class="co"># failure rate of high-dose arm: period 1, period 2</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>           <span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">/</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span> <span class="sc">/</span> .<span class="dv">6</span>)))</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>three_arm_dropout_rate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  <span class="at">stratum =</span> <span class="st">&quot;All&quot;</span>,</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  <span class="at">period =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;low-dose&quot;</span>, <span class="st">&quot;high-dose&quot;</span>),</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>  <span class="at">duration =</span> <span class="fu">rep</span>(<span class="cn">Inf</span>, <span class="dv">3</span>), </span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>  <span class="at">rate =</span> <span class="fu">rep</span>(<span class="fl">0.001</span>, <span class="dv">3</span>))</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>uncut_data_d <span class="ot">&lt;-</span> <span class="fu">sim_pw_surv</span>(<span class="at">n =</span> n,</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>                            <span class="at">stratum =</span> <span class="fu">data.frame</span>(<span class="at">stratum =</span> <span class="st">&quot;All&quot;</span>),</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>                            <span class="at">block =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;control&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;low-dose&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;high-dose&quot;</span>, <span class="dv">2</span>)),</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>                            <span class="at">enroll_rate =</span> enroll_rate,</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>                            <span class="at">fail_rate =</span> three_arm_fail_rate,</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>                            <span class="at">dropout_rate =</span> three_arm_dropout_rate)</span></code></pre></div>
<p>For illustration purposes, we will focus on scenario b) for the
following discussion.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>uncut_data <span class="ot">&lt;-</span> uncut_data_b</span></code></pre></div>
</div>
</div>
<div id="step-2-cut-data" class="section level1">
<h1>Step 2: Cut data</h1>
<p>The <code>get_analysis_date()</code> derives analysis date for
interim/final analysis given multiple conditions, see <a href="https://merck.github.io/simtrial/reference/get_analysis_date.html">the
help page of <code>get_analysis_date()</code> at the pkgdown
website</a>.</p>
<p>Users can cut for analysis at the 24th month and there are 300
events, whichever arrives later. This is equivalent to
<code>timing_type = 4</code> in <code>sim_fixed_n()</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>cut_date_a <span class="ot">&lt;-</span> <span class="fu">get_analysis_date</span>(<span class="at">data =</span> uncut_data,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                                <span class="at">planned_calendar_time =</span> <span class="dv">24</span>,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                                <span class="at">target_event_overall =</span> <span class="dv">300</span>)</span></code></pre></div>
<p>Users can also cut by the maximum of targeted 300 event and minimum
follow-up 12 months. This is equivalent to <code>timing_type = 5</code>
in <code>sim_fixed_n()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>cut_date_b <span class="ot">&lt;-</span> <span class="fu">get_analysis_date</span>(<span class="at">data =</span> uncut_data,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                                <span class="at">min_followup =</span> <span class="dv">12</span>,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                                <span class="at">target_event_overall =</span> <span class="dv">300</span>)</span></code></pre></div>
<p>Users can cut data when there are 300 events, with maximum time
extension to reach targeted events of 24 months. This is not enabled in
<code>timing_type</code> of <code>sim_fixed_n()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>cut_date_c <span class="ot">&lt;-</span> <span class="fu">get_analysis_date</span>(<span class="at">data =</span> uncut_data,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                                <span class="at">max_extension_for_target_event =</span> <span class="dv">12</span>,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                                <span class="at">target_event_overall =</span> <span class="dv">300</span>)</span></code></pre></div>
<p>Users can cut data after 12 months followup when 80% of the patients
are enrolled in the overall population as below. This is not enabled in
<code>timing_type</code> of <code>sim_fixed_n()</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>cut_date_d <span class="ot">&lt;-</span> <span class="fu">get_analysis_date</span>(<span class="at">data =</span> uncut_data,</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>                                <span class="at">min_n_overall =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fl">0.8</span>,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>                                <span class="at">min_followup =</span> <span class="dv">12</span>)</span></code></pre></div>
<p>More examples are available in the <a href="https://merck.github.io/simtrial/reference/get_analysis_date.html">reference
page of <code>get_analysis_date()</code></a> For illustration purposes,
we will focus on scenario d) for the following discussion.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>cut_date <span class="ot">&lt;-</span> cut_date_d</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The cutoff date is &quot;</span>, <span class="fu">round</span>(cut_date, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## The cutoff date is  20.19</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>cut_data <span class="ot">&lt;-</span> uncut_data <span class="sc">|&gt;</span> <span class="fu">cut_data_by_date</span>(cut_date)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>cut_data <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="sc">|&gt;</span> <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">tab_header</span>(<span class="fu">paste0</span>(<span class="st">&quot;An Overview of TTE data Cut at &quot;</span>, <span class="fu">round</span>(cut_date, <span class="dv">2</span>), <span class="st">&quot;Months&quot;</span>))</span></code></pre></div>
<div id="cajclanokf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cajclanokf table {
font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
}
#cajclanokf thead, #cajclanokf tbody, #cajclanokf tfoot, #cajclanokf tr, #cajclanokf td, #cajclanokf th {
border-style: none;
}
#cajclanokf p {
margin: 0;
padding: 0;
}
#cajclanokf .gt_table {
display: table;
border-collapse: collapse;
line-height: normal;
margin-left: auto;
margin-right: auto;
color: #333333;
font-size: 16px;
font-weight: normal;
font-style: normal;
background-color: #FFFFFF;
width: auto;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #A8A8A8;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #A8A8A8;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
}
#cajclanokf .gt_caption {
padding-top: 4px;
padding-bottom: 4px;
}
#cajclanokf .gt_title {
color: #333333;
font-size: 125%;
font-weight: initial;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
border-bottom-color: #FFFFFF;
border-bottom-width: 0;
}
#cajclanokf .gt_subtitle {
color: #333333;
font-size: 85%;
font-weight: initial;
padding-top: 3px;
padding-bottom: 5px;
padding-left: 5px;
padding-right: 5px;
border-top-color: #FFFFFF;
border-top-width: 0;
}
#cajclanokf .gt_heading {
background-color: #FFFFFF;
text-align: center;
border-bottom-color: #FFFFFF;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
}
#cajclanokf .gt_bottom_border {
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#cajclanokf .gt_col_headings {
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
}
#cajclanokf .gt_col_heading {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: normal;
text-transform: inherit;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: bottom;
padding-top: 5px;
padding-bottom: 6px;
padding-left: 5px;
padding-right: 5px;
overflow-x: hidden;
}
#cajclanokf .gt_column_spanner_outer {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: normal;
text-transform: inherit;
padding-top: 0;
padding-bottom: 0;
padding-left: 4px;
padding-right: 4px;
}
#cajclanokf .gt_column_spanner_outer:first-child {
padding-left: 0;
}
#cajclanokf .gt_column_spanner_outer:last-child {
padding-right: 0;
}
#cajclanokf .gt_column_spanner {
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
vertical-align: bottom;
padding-top: 5px;
padding-bottom: 5px;
overflow-x: hidden;
display: inline-block;
width: 100%;
}
#cajclanokf .gt_spanner_row {
border-bottom-style: hidden;
}
#cajclanokf .gt_group_heading {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: middle;
text-align: left;
}
#cajclanokf .gt_empty_group_heading {
padding: 0.5px;
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
vertical-align: middle;
}
#cajclanokf .gt_from_md > :first-child {
margin-top: 0;
}
#cajclanokf .gt_from_md > :last-child {
margin-bottom: 0;
}
#cajclanokf .gt_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
margin: 10px;
border-top-style: solid;
border-top-width: 1px;
border-top-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: middle;
overflow-x: hidden;
}
#cajclanokf .gt_stub {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-right-style: solid;
border-right-width: 2px;
border-right-color: #D3D3D3;
padding-left: 5px;
padding-right: 5px;
}
#cajclanokf .gt_stub_row_group {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-right-style: solid;
border-right-width: 2px;
border-right-color: #D3D3D3;
padding-left: 5px;
padding-right: 5px;
vertical-align: top;
}
#cajclanokf .gt_row_group_first td {
border-top-width: 2px;
}
#cajclanokf .gt_row_group_first th {
border-top-width: 2px;
}
#cajclanokf .gt_summary_row {
color: #333333;
background-color: #FFFFFF;
text-transform: inherit;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
}
#cajclanokf .gt_first_summary_row {
border-top-style: solid;
border-top-color: #D3D3D3;
}
#cajclanokf .gt_first_summary_row.thick {
border-top-width: 2px;
}
#cajclanokf .gt_last_summary_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#cajclanokf .gt_grand_summary_row {
color: #333333;
background-color: #FFFFFF;
text-transform: inherit;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
}
#cajclanokf .gt_first_grand_summary_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-top-style: double;
border-top-width: 6px;
border-top-color: #D3D3D3;
}
#cajclanokf .gt_last_grand_summary_row_top {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-bottom-style: double;
border-bottom-width: 6px;
border-bottom-color: #D3D3D3;
}
#cajclanokf .gt_striped {
background-color: rgba(128, 128, 128, 0.05);
}
#cajclanokf .gt_table_body {
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#cajclanokf .gt_footnotes {
color: #333333;
background-color: #FFFFFF;
border-bottom-style: none;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
}
#cajclanokf .gt_footnote {
margin: 0px;
font-size: 90%;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
}
#cajclanokf .gt_sourcenotes {
color: #333333;
background-color: #FFFFFF;
border-bottom-style: none;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
}
#cajclanokf .gt_sourcenote {
font-size: 90%;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
}
#cajclanokf .gt_left {
text-align: left;
}
#cajclanokf .gt_center {
text-align: center;
}
#cajclanokf .gt_right {
text-align: right;
font-variant-numeric: tabular-nums;
}
#cajclanokf .gt_font_normal {
font-weight: normal;
}
#cajclanokf .gt_font_bold {
font-weight: bold;
}
#cajclanokf .gt_font_italic {
font-style: italic;
}
#cajclanokf .gt_super {
font-size: 65%;
}
#cajclanokf .gt_footnote_marks {
font-size: 75%;
vertical-align: 0.4em;
position: initial;
}
#cajclanokf .gt_asterisk {
font-size: 100%;
vertical-align: 0;
}
#cajclanokf .gt_indent_1 {
text-indent: 5px;
}
#cajclanokf .gt_indent_2 {
text-indent: 10px;
}
#cajclanokf .gt_indent_3 {
text-indent: 15px;
}
#cajclanokf .gt_indent_4 {
text-indent: 20px;
}
#cajclanokf .gt_indent_5 {
text-indent: 25px;
}
#cajclanokf .katex-display {
display: inline-flex !important;
margin-bottom: 0.75em !important;
}
#cajclanokf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>An Overview of TTE data Cut at 20.19Months</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="tte">tte</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="event">event</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="stratum">stratum</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="treatment">treatment</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="tte" class="gt_row gt_right">19.288154</td>
<td headers="event" class="gt_row gt_right">1</td>
<td headers="stratum" class="gt_row gt_left">All</td>
<td headers="treatment" class="gt_row gt_left">control</td></tr>
    <tr><td headers="tte" class="gt_row gt_right">20.029362</td>
<td headers="event" class="gt_row gt_right">0</td>
<td headers="stratum" class="gt_row gt_left">All</td>
<td headers="treatment" class="gt_row gt_left">experimental</td></tr>
    <tr><td headers="tte" class="gt_row gt_right">5.400825</td>
<td headers="event" class="gt_row gt_right">1</td>
<td headers="stratum" class="gt_row gt_left">All</td>
<td headers="treatment" class="gt_row gt_left">control</td></tr>
    <tr><td headers="tte" class="gt_row gt_right">8.723331</td>
<td headers="event" class="gt_row gt_right">1</td>
<td headers="stratum" class="gt_row gt_left">All</td>
<td headers="treatment" class="gt_row gt_left">experimental</td></tr>
    <tr><td headers="tte" class="gt_row gt_right">19.860289</td>
<td headers="event" class="gt_row gt_right">0</td>
<td headers="stratum" class="gt_row gt_left">All</td>
<td headers="treatment" class="gt_row gt_left">control</td></tr>
    <tr><td headers="tte" class="gt_row gt_right">4.589687</td>
<td headers="event" class="gt_row gt_right">1</td>
<td headers="stratum" class="gt_row gt_left">All</td>
<td headers="treatment" class="gt_row gt_left">experimental</td></tr>
  </tbody>
  
</table>
</div>
</div>
<div id="step-3-run-tests" class="section level1">
<h1>Step 3: Run tests</h1>
<p>The simtrial package provides many options for testing methods,
including (weighted) logrank tests, RMST test, milestone test, and
MaxComboi test, see the [Section Compute p-values/test statistics at
the pkgdown reference page] (<a href="https://merck.github.io/simtrial/reference/index.html#compute-p-values-test-statistics" class="uri">https://merck.github.io/simtrial/reference/index.html#compute-p-values-test-statistics</a>).</p>
<p>The following code lists all possible tests available in simtrial.
Users can select one of the tests listed above or combine the testing
results to make comparisons across tests. For demonstration purposes, we
will aggregate all tests together.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Logrank test</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>sim_res_lr <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">wlr</span>(<span class="at">weight =</span> <span class="fu">fh</span>(<span class="at">rho =</span> <span class="dv">0</span>, <span class="at">gamma =</span> <span class="dv">0</span>))</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co"># weighted logrank test by Fleming-Harrington weights</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>sim_res_fh <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">wlr</span>(<span class="at">weight =</span> <span class="fu">fh</span>(<span class="at">rho =</span> <span class="dv">0</span>, <span class="at">gamma =</span> <span class="fl">0.5</span>))</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co"># Modestly weighted logrank test</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>sim_res_mb <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">wlr</span>(<span class="at">weight =</span> <span class="fu">mb</span>(<span class="at">delay =</span> <span class="cn">Inf</span>, <span class="at">w_max =</span> <span class="dv">2</span>))</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co"># Weighted logrank test by Xu 2017&#39;s early zero weights</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>sim_res_xu <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">wlr</span>(<span class="at">weight =</span> <span class="fu">early_zero</span>(<span class="at">early_period =</span> <span class="dv">3</span>))</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co"># RMST test</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>sim_res_rmst <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">rmst</span>(<span class="at">tau =</span> <span class="dv">10</span>)</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co"># Milestone test</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>sim_res_ms <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">milestone</span>(<span class="at">ms_time =</span> <span class="dv">10</span>)</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co"># Maxcombo tests comboing multiple weighted logrank test with Fleming-Harrington weights</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>sim_res_mc <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">maxcombo</span>(<span class="at">rho =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">gamma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p>The output of the tests mentioned above are lists including:</p>
<ul>
<li>The testing method employed (WLR, RMST, milestone, or MaxCombo),
which can be accessed using <code>sim_res_rmst$method</code>.</li>
<li>The parameters associated with the testing method. For instance, the
RMST test parameter is 10, indicating that the RMST is evaluated at
month 10. You can find this information using
<code>sim_res_rmst$parameter</code>.</li>
<li>The point estimate and standard error for the testing method used.
For example, the point estimate for RMST represents the survival
difference between the experimental group and the control group. This
estimate can be retrieved with <code>sim_res_rmst$estimate</code> and
<code>sim_res_rmst$se</code>.</li>
<li>The Z-score for the testing method, accessible via
<code>sim_res_rmst$z</code>. Please note that the Z-score is not
provided for the MaxCombo test; instead, the p-value is reported
(<code>sim_res_mc$p_value</code>).</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>sim_res <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="sc">~</span>Method, <span class="sc">~</span>Parameter, <span class="sc">~</span>Z, <span class="sc">~</span>Estimate, <span class="sc">~</span>SE, <span class="sc">~</span><span class="st">`</span><span class="at">P value</span><span class="st">`</span>,</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  sim_res_lr<span class="sc">$</span>method, sim_res_lr<span class="sc">$</span>parameter, sim_res_lr<span class="sc">$</span>z, sim_res_lr<span class="sc">$</span>estimate, sim_res_lr<span class="sc">$</span>se, <span class="fu">pnorm</span>(<span class="sc">-</span>sim_res_lr<span class="sc">$</span>z),</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  sim_res_fh<span class="sc">$</span>method, sim_res_fh<span class="sc">$</span>parameter, sim_res_fh<span class="sc">$</span>z, sim_res_fh<span class="sc">$</span>estimate, sim_res_fh<span class="sc">$</span>se, <span class="fu">pnorm</span>(<span class="sc">-</span>sim_res_fh<span class="sc">$</span>z),</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  sim_res_mb<span class="sc">$</span>method, sim_res_mb<span class="sc">$</span>parameter, sim_res_mb<span class="sc">$</span>z, sim_res_mb<span class="sc">$</span>estimate, sim_res_mb<span class="sc">$</span>se, <span class="fu">pnorm</span>(<span class="sc">-</span>sim_res_mb<span class="sc">$</span>z),</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  sim_res_xu<span class="sc">$</span>method, sim_res_xu<span class="sc">$</span>parameter, sim_res_xu<span class="sc">$</span>z, sim_res_xu<span class="sc">$</span>estimate, sim_res_xu<span class="sc">$</span>se, <span class="fu">pnorm</span>(<span class="sc">-</span>sim_res_xu<span class="sc">$</span>z),</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  sim_res_rmst<span class="sc">$</span>method, sim_res_rmst<span class="sc">$</span>parameter<span class="sc">|&gt;</span> <span class="fu">as.character</span>(), sim_res_rmst<span class="sc">$</span>z, sim_res_rmst<span class="sc">$</span>estimate, sim_res_rmst<span class="sc">$</span>se, <span class="fu">pnorm</span>(<span class="sc">-</span>sim_res_rmst<span class="sc">$</span>z),</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  sim_res_ms<span class="sc">$</span>method, sim_res_ms<span class="sc">$</span>parameter <span class="sc">|&gt;</span> <span class="fu">as.character</span>(), sim_res_ms<span class="sc">$</span>z, sim_res_ms<span class="sc">$</span>estimate, sim_res_ms<span class="sc">$</span>se, <span class="fu">pnorm</span>(<span class="sc">-</span>sim_res_ms<span class="sc">$</span>z),</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  sim_res_mc<span class="sc">$</span>method, sim_res_mc<span class="sc">$</span>parameter, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, sim_res_mc<span class="sc">$</span>p_value</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  ) </span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>sim_res <span class="sc">|&gt;</span> <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">tab_header</span>(<span class="st">&quot;One Simulation Results&quot;</span>)</span></code></pre></div>
<div id="itqjmkpiic" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#itqjmkpiic table {
font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
}
#itqjmkpiic thead, #itqjmkpiic tbody, #itqjmkpiic tfoot, #itqjmkpiic tr, #itqjmkpiic td, #itqjmkpiic th {
border-style: none;
}
#itqjmkpiic p {
margin: 0;
padding: 0;
}
#itqjmkpiic .gt_table {
display: table;
border-collapse: collapse;
line-height: normal;
margin-left: auto;
margin-right: auto;
color: #333333;
font-size: 16px;
font-weight: normal;
font-style: normal;
background-color: #FFFFFF;
width: auto;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #A8A8A8;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #A8A8A8;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
}
#itqjmkpiic .gt_caption {
padding-top: 4px;
padding-bottom: 4px;
}
#itqjmkpiic .gt_title {
color: #333333;
font-size: 125%;
font-weight: initial;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
border-bottom-color: #FFFFFF;
border-bottom-width: 0;
}
#itqjmkpiic .gt_subtitle {
color: #333333;
font-size: 85%;
font-weight: initial;
padding-top: 3px;
padding-bottom: 5px;
padding-left: 5px;
padding-right: 5px;
border-top-color: #FFFFFF;
border-top-width: 0;
}
#itqjmkpiic .gt_heading {
background-color: #FFFFFF;
text-align: center;
border-bottom-color: #FFFFFF;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
}
#itqjmkpiic .gt_bottom_border {
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#itqjmkpiic .gt_col_headings {
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
}
#itqjmkpiic .gt_col_heading {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: normal;
text-transform: inherit;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: bottom;
padding-top: 5px;
padding-bottom: 6px;
padding-left: 5px;
padding-right: 5px;
overflow-x: hidden;
}
#itqjmkpiic .gt_column_spanner_outer {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: normal;
text-transform: inherit;
padding-top: 0;
padding-bottom: 0;
padding-left: 4px;
padding-right: 4px;
}
#itqjmkpiic .gt_column_spanner_outer:first-child {
padding-left: 0;
}
#itqjmkpiic .gt_column_spanner_outer:last-child {
padding-right: 0;
}
#itqjmkpiic .gt_column_spanner {
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
vertical-align: bottom;
padding-top: 5px;
padding-bottom: 5px;
overflow-x: hidden;
display: inline-block;
width: 100%;
}
#itqjmkpiic .gt_spanner_row {
border-bottom-style: hidden;
}
#itqjmkpiic .gt_group_heading {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: middle;
text-align: left;
}
#itqjmkpiic .gt_empty_group_heading {
padding: 0.5px;
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
vertical-align: middle;
}
#itqjmkpiic .gt_from_md > :first-child {
margin-top: 0;
}
#itqjmkpiic .gt_from_md > :last-child {
margin-bottom: 0;
}
#itqjmkpiic .gt_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
margin: 10px;
border-top-style: solid;
border-top-width: 1px;
border-top-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: middle;
overflow-x: hidden;
}
#itqjmkpiic .gt_stub {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-right-style: solid;
border-right-width: 2px;
border-right-color: #D3D3D3;
padding-left: 5px;
padding-right: 5px;
}
#itqjmkpiic .gt_stub_row_group {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-right-style: solid;
border-right-width: 2px;
border-right-color: #D3D3D3;
padding-left: 5px;
padding-right: 5px;
vertical-align: top;
}
#itqjmkpiic .gt_row_group_first td {
border-top-width: 2px;
}
#itqjmkpiic .gt_row_group_first th {
border-top-width: 2px;
}
#itqjmkpiic .gt_summary_row {
color: #333333;
background-color: #FFFFFF;
text-transform: inherit;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
}
#itqjmkpiic .gt_first_summary_row {
border-top-style: solid;
border-top-color: #D3D3D3;
}
#itqjmkpiic .gt_first_summary_row.thick {
border-top-width: 2px;
}
#itqjmkpiic .gt_last_summary_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#itqjmkpiic .gt_grand_summary_row {
color: #333333;
background-color: #FFFFFF;
text-transform: inherit;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
}
#itqjmkpiic .gt_first_grand_summary_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-top-style: double;
border-top-width: 6px;
border-top-color: #D3D3D3;
}
#itqjmkpiic .gt_last_grand_summary_row_top {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-bottom-style: double;
border-bottom-width: 6px;
border-bottom-color: #D3D3D3;
}
#itqjmkpiic .gt_striped {
background-color: rgba(128, 128, 128, 0.05);
}
#itqjmkpiic .gt_table_body {
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#itqjmkpiic .gt_footnotes {
color: #333333;
background-color: #FFFFFF;
border-bottom-style: none;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
}
#itqjmkpiic .gt_footnote {
margin: 0px;
font-size: 90%;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
}
#itqjmkpiic .gt_sourcenotes {
color: #333333;
background-color: #FFFFFF;
border-bottom-style: none;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
}
#itqjmkpiic .gt_sourcenote {
font-size: 90%;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
}
#itqjmkpiic .gt_left {
text-align: left;
}
#itqjmkpiic .gt_center {
text-align: center;
}
#itqjmkpiic .gt_right {
text-align: right;
font-variant-numeric: tabular-nums;
}
#itqjmkpiic .gt_font_normal {
font-weight: normal;
}
#itqjmkpiic .gt_font_bold {
font-weight: bold;
}
#itqjmkpiic .gt_font_italic {
font-style: italic;
}
#itqjmkpiic .gt_super {
font-size: 65%;
}
#itqjmkpiic .gt_footnote_marks {
font-size: 75%;
vertical-align: 0.4em;
position: initial;
}
#itqjmkpiic .gt_asterisk {
font-size: 100%;
vertical-align: 0;
}
#itqjmkpiic .gt_indent_1 {
text-indent: 5px;
}
#itqjmkpiic .gt_indent_2 {
text-indent: 10px;
}
#itqjmkpiic .gt_indent_3 {
text-indent: 15px;
}
#itqjmkpiic .gt_indent_4 {
text-indent: 20px;
}
#itqjmkpiic .gt_indent_5 {
text-indent: 25px;
}
#itqjmkpiic .katex-display {
display: inline-flex !important;
margin-bottom: 0.75em !important;
}
#itqjmkpiic div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>One Simulation Results</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Method">Method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Parameter">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Z">Z</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="SE">SE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="P-value">P value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Method" class="gt_row gt_left">WLR</td>
<td headers="Parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="Z" class="gt_row gt_right">1.788225</td>
<td headers="Estimate" class="gt_row gt_right">-9.3460253</td>
<td headers="SE" class="gt_row gt_right">5.2264273</td>
<td headers="P value" class="gt_row gt_right">0.036869897</td></tr>
    <tr><td headers="Method" class="gt_row gt_left">WLR</td>
<td headers="Parameter" class="gt_row gt_left">FH(rho=0, gamma=0.5)</td>
<td headers="Z" class="gt_row gt_right">2.360073</td>
<td headers="Estimate" class="gt_row gt_right">-6.8225888</td>
<td headers="SE" class="gt_row gt_right">2.8908376</td>
<td headers="P value" class="gt_row gt_right">0.009135661</td></tr>
    <tr><td headers="Method" class="gt_row gt_left">WLR</td>
<td headers="Parameter" class="gt_row gt_left">MB(delay = Inf, max_weight = 2)</td>
<td headers="Z" class="gt_row gt_right">2.130368</td>
<td headers="Estimate" class="gt_row gt_right">-16.9085058</td>
<td headers="SE" class="gt_row gt_right">7.9368946</td>
<td headers="P value" class="gt_row gt_right">0.016570624</td></tr>
    <tr><td headers="Method" class="gt_row gt_left">WLR</td>
<td headers="Parameter" class="gt_row gt_left">Xu 2017 with first 3 months of 0 weights</td>
<td headers="Z" class="gt_row gt_right">2.600908</td>
<td headers="Estimate" class="gt_row gt_right">-11.0553977</td>
<td headers="SE" class="gt_row gt_right">4.2505921</td>
<td headers="P value" class="gt_row gt_right">0.004648873</td></tr>
    <tr><td headers="Method" class="gt_row gt_left">RMST</td>
<td headers="Parameter" class="gt_row gt_left">10</td>
<td headers="Z" class="gt_row gt_right">1.128125</td>
<td headers="Estimate" class="gt_row gt_right">0.5589405</td>
<td headers="SE" class="gt_row gt_right">0.4954596</td>
<td headers="P value" class="gt_row gt_right">0.129633491</td></tr>
    <tr><td headers="Method" class="gt_row gt_left">milestone</td>
<td headers="Parameter" class="gt_row gt_left">10</td>
<td headers="Z" class="gt_row gt_right">1.940708</td>
<td headers="Estimate" class="gt_row gt_right">0.4501018</td>
<td headers="SE" class="gt_row gt_right">0.2319266</td>
<td headers="P value" class="gt_row gt_right">0.026146861</td></tr>
    <tr><td headers="Method" class="gt_row gt_left">MaxCombo</td>
<td headers="Parameter" class="gt_row gt_left">FH(0, 0) + FH(0, 0.5)</td>
<td headers="Z" class="gt_row gt_right">NA</td>
<td headers="Estimate" class="gt_row gt_right">NA</td>
<td headers="SE" class="gt_row gt_right">NA</td>
<td headers="P value" class="gt_row gt_right">0.012855297</td></tr>
  </tbody>
  
</table>
</div>
</div>
<div id="step-4-perform-the-above-single-simulation-repeatedly" class="section level1">
<h1>Step 4: Perform the above single simulation repeatedly</h1>
<p>We will now merge Steps 1 to 3 into a single function named
<code>one_sim()</code>, which facilitates a single simulation run. The
construction of <code>one_sim()</code> involves copying all the lines of
code from Steps 1 to 3.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>one_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">sim_id =</span> <span class="dv">1</span>, </span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>                    <span class="co"># arguments from Step 1: design characteristic</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                    n, stratum, enroll_rate, fail_rate, dropout_rate, block, </span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                    <span class="co"># arguments from Step 2 cutting method</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>                    min_n_overall, min_followup,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>                    <span class="co"># arguments from Step 3 testing method</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>                    fh, mb, xu, rmst, ms, mc</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>                    ) {</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>    <span class="co"># Step 1: simulate a time-to-event data</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>    uncut_data <span class="ot">&lt;-</span> <span class="fu">sim_pw_surv</span>(</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>      <span class="at">n =</span> n,</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>      <span class="at">stratum =</span> stratum,</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>      <span class="at">block =</span> block,</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>      <span class="at">enroll_rate =</span> enroll_rate,</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>      <span class="at">fail_rate =</span> fail_rate,</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>      <span class="at">dropout_rate =</span> dropout_rate) </span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>    </span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>    <span class="do">## Step 2: Cut data</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>    cut_date <span class="ot">&lt;-</span> <span class="fu">get_analysis_date</span>(<span class="at">min_n_overall =</span> min_n_overall, <span class="at">min_followup =</span> min_followup, <span class="at">data =</span> uncut_data)</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>    cut_data <span class="ot">&lt;-</span> uncut_data <span class="sc">|&gt;</span> <span class="fu">cut_data_by_date</span>(cut_date)</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>    </span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>    <span class="co"># Step 3: Run tests</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>    sim_res_lr <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">wlr</span>(<span class="at">weight =</span> <span class="fu">fh</span>(<span class="at">rho =</span> <span class="dv">0</span>, <span class="at">gamma =</span> <span class="dv">0</span>))</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a>    sim_res_fh <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">wlr</span>(<span class="at">weight =</span> <span class="fu">fh</span>(<span class="at">rho =</span> fh<span class="sc">$</span>rho, <span class="at">gamma =</span> fh<span class="sc">$</span>gamma))</span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>    sim_res_mb <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">wlr</span>(<span class="at">weight =</span> <span class="fu">mb</span>(<span class="at">delay =</span> mb<span class="sc">$</span>delay, <span class="at">w_max =</span> mb<span class="sc">$</span>w_max))</span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a>    sim_res_xu <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">wlr</span>(<span class="at">weight =</span> <span class="fu">early_zero</span>(<span class="at">early_period =</span> xu<span class="sc">$</span>early_period))</span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a>    sim_res_rmst <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">rmst</span>(<span class="at">tau =</span> rmst<span class="sc">$</span>tau)</span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a>    sim_res_ms <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">milestone</span>(<span class="at">ms_time =</span> ms<span class="sc">$</span>ms_time)</span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a>    sim_res_mc <span class="ot">&lt;-</span> cut_data <span class="sc">|&gt;</span> <span class="fu">maxcombo</span>(<span class="at">rho =</span> mc<span class="sc">$</span>rho, <span class="at">gamma =</span> mc<span class="sc">$</span>gamma)</span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a>    </span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a>    sim_res <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a>      <span class="sc">~</span><span class="st">`</span><span class="at">Sim ID</span><span class="st">`</span>, <span class="sc">~</span>Method, <span class="sc">~</span>Parameter, <span class="sc">~</span>Z, <span class="sc">~</span>Estimate, <span class="sc">~</span>SE, <span class="sc">~</span><span class="st">`</span><span class="at">P value</span><span class="st">`</span>,</span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a>      sim_id, sim_res_lr<span class="sc">$</span>method, sim_res_lr<span class="sc">$</span>parameter, sim_res_lr<span class="sc">$</span>z, sim_res_lr<span class="sc">$</span>estimate, sim_res_lr<span class="sc">$</span>se, <span class="fu">pnorm</span>(<span class="sc">-</span>sim_res_lr<span class="sc">$</span>z),</span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a>      sim_id, sim_res_fh<span class="sc">$</span>method, sim_res_fh<span class="sc">$</span>parameter, sim_res_fh<span class="sc">$</span>z, sim_res_fh<span class="sc">$</span>estimate, sim_res_fh<span class="sc">$</span>se, <span class="fu">pnorm</span>(<span class="sc">-</span>sim_res_fh<span class="sc">$</span>z),</span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a>      sim_id, sim_res_mb<span class="sc">$</span>method, sim_res_mb<span class="sc">$</span>parameter, sim_res_mb<span class="sc">$</span>z, sim_res_mb<span class="sc">$</span>estimate, sim_res_mb<span class="sc">$</span>se, <span class="fu">pnorm</span>(<span class="sc">-</span>sim_res_mb<span class="sc">$</span>z),</span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a>      sim_id, sim_res_xu<span class="sc">$</span>method, sim_res_xu<span class="sc">$</span>parameter, sim_res_xu<span class="sc">$</span>z, sim_res_xu<span class="sc">$</span>estimate, sim_res_xu<span class="sc">$</span>se, <span class="fu">pnorm</span>(<span class="sc">-</span>sim_res_xu<span class="sc">$</span>z),</span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a>      sim_id, sim_res_rmst<span class="sc">$</span>method, sim_res_rmst<span class="sc">$</span>parameter<span class="sc">|&gt;</span> <span class="fu">as.character</span>(), sim_res_rmst<span class="sc">$</span>z, sim_res_rmst<span class="sc">$</span>estimate, sim_res_rmst<span class="sc">$</span>se, <span class="fu">pnorm</span>(<span class="sc">-</span>sim_res_rmst<span class="sc">$</span>z),</span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a>      sim_id, sim_res_ms<span class="sc">$</span>method, sim_res_ms<span class="sc">$</span>parameter <span class="sc">|&gt;</span> <span class="fu">as.character</span>(), sim_res_ms<span class="sc">$</span>z, sim_res_ms<span class="sc">$</span>estimate, sim_res_ms<span class="sc">$</span>se, <span class="fu">pnorm</span>(<span class="sc">-</span>sim_res_ms<span class="sc">$</span>z),</span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a>      sim_id, sim_res_mc<span class="sc">$</span>method, sim_res_mc<span class="sc">$</span>parameter, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, sim_res_mc<span class="sc">$</span>p_value</span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a>  ) </span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a>      </span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a>    <span class="fu">return</span>(sim_res)</span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a>}</span></code></pre></div>
<p>After that, we will execute <code>one_sim()</code> multiple times
using parallel computation. The following lines of code uses 2 workers
to run 100 simulations.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">plan</span>(<span class="st">&quot;multisession&quot;</span>, <span class="at">workers =</span> <span class="dv">2</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">foreach</span>(</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="at">sim_id =</span> <span class="fu">seq_len</span>(n_sim),</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="at">.errorhandling =</span> <span class="st">&quot;stop&quot;</span>,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="at">.options.future =</span> <span class="fu">list</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  ) <span class="sc">%dofuture%</span> {</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>    ans_new <span class="ot">&lt;-</span> <span class="fu">one_sim</span>(</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>      <span class="at">sim_id =</span> sim_id, </span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>      <span class="co"># arguments from Step 1: design characteristic</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>      <span class="at">n =</span> n, </span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>      <span class="at">stratum =</span> stratum, </span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>      <span class="at">enroll_rate =</span> enroll_rate, </span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>      <span class="at">fail_rate =</span> <span class="fu">to_sim_pw_surv</span>(fail_rate)<span class="sc">$</span>fail_rate, </span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>      <span class="at">dropout_rate =</span> differential_dropout_rate, </span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>      <span class="at">block =</span> block, </span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>      <span class="co"># arguments from Step 2 cutting method</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>      <span class="at">min_n_overall =</span> <span class="dv">500</span> <span class="sc">*</span> <span class="fl">0.8</span>,</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>      <span class="at">min_followup =</span> <span class="dv">12</span>,</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>      <span class="co"># arguments from Step 3 testing method</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>      <span class="at">fh =</span> <span class="fu">list</span>(<span class="at">rho =</span> <span class="dv">0</span>, <span class="at">gamma =</span> <span class="fl">0.5</span>), </span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>      <span class="at">mb =</span> <span class="fu">list</span>(<span class="at">delay =</span> <span class="cn">Inf</span>, <span class="at">w_max =</span> <span class="dv">2</span>), </span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a>      <span class="at">xu =</span> <span class="fu">list</span>(<span class="at">early_period =</span> <span class="dv">3</span>), </span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a>      <span class="at">rmst =</span> <span class="fu">list</span>(<span class="at">tau =</span> <span class="dv">10</span>), </span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a>      <span class="at">ms =</span> <span class="fu">list</span>(<span class="at">ms_time =</span> <span class="dv">10</span>), </span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a>      <span class="at">mc =</span> <span class="fu">list</span>(<span class="at">rho =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">gamma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a>      )</span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a>                              </span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a>    ans_new</span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a>  }</span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a></span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a>ans <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">rbindlist</span>(ans)</span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a><span class="fu">plan</span>(<span class="st">&quot;sequential&quot;</span>)</span></code></pre></div>
<p>The output from the parallel computation resembles the output of
<code>sim_fix_n()</code> described in the vignette <a href="https://merck.github.io/simtrial/articles/sim_fixed_design_simple.html">Simulate
Fixed Designs with Ease via sim_fixed_n</a>. Each row in the output
corresponds to the simulation results for each testing method per each
repeation.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>ans <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="sc">|&gt;</span> <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">tab_header</span>(<span class="st">&quot;Overview Each Simulation results&quot;</span>)</span></code></pre></div>
<div id="dzawjmqldw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dzawjmqldw table {
font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
}
#dzawjmqldw thead, #dzawjmqldw tbody, #dzawjmqldw tfoot, #dzawjmqldw tr, #dzawjmqldw td, #dzawjmqldw th {
border-style: none;
}
#dzawjmqldw p {
margin: 0;
padding: 0;
}
#dzawjmqldw .gt_table {
display: table;
border-collapse: collapse;
line-height: normal;
margin-left: auto;
margin-right: auto;
color: #333333;
font-size: 16px;
font-weight: normal;
font-style: normal;
background-color: #FFFFFF;
width: auto;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #A8A8A8;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #A8A8A8;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
}
#dzawjmqldw .gt_caption {
padding-top: 4px;
padding-bottom: 4px;
}
#dzawjmqldw .gt_title {
color: #333333;
font-size: 125%;
font-weight: initial;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
border-bottom-color: #FFFFFF;
border-bottom-width: 0;
}
#dzawjmqldw .gt_subtitle {
color: #333333;
font-size: 85%;
font-weight: initial;
padding-top: 3px;
padding-bottom: 5px;
padding-left: 5px;
padding-right: 5px;
border-top-color: #FFFFFF;
border-top-width: 0;
}
#dzawjmqldw .gt_heading {
background-color: #FFFFFF;
text-align: center;
border-bottom-color: #FFFFFF;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
}
#dzawjmqldw .gt_bottom_border {
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#dzawjmqldw .gt_col_headings {
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
}
#dzawjmqldw .gt_col_heading {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: normal;
text-transform: inherit;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: bottom;
padding-top: 5px;
padding-bottom: 6px;
padding-left: 5px;
padding-right: 5px;
overflow-x: hidden;
}
#dzawjmqldw .gt_column_spanner_outer {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: normal;
text-transform: inherit;
padding-top: 0;
padding-bottom: 0;
padding-left: 4px;
padding-right: 4px;
}
#dzawjmqldw .gt_column_spanner_outer:first-child {
padding-left: 0;
}
#dzawjmqldw .gt_column_spanner_outer:last-child {
padding-right: 0;
}
#dzawjmqldw .gt_column_spanner {
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
vertical-align: bottom;
padding-top: 5px;
padding-bottom: 5px;
overflow-x: hidden;
display: inline-block;
width: 100%;
}
#dzawjmqldw .gt_spanner_row {
border-bottom-style: hidden;
}
#dzawjmqldw .gt_group_heading {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: middle;
text-align: left;
}
#dzawjmqldw .gt_empty_group_heading {
padding: 0.5px;
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
vertical-align: middle;
}
#dzawjmqldw .gt_from_md > :first-child {
margin-top: 0;
}
#dzawjmqldw .gt_from_md > :last-child {
margin-bottom: 0;
}
#dzawjmqldw .gt_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
margin: 10px;
border-top-style: solid;
border-top-width: 1px;
border-top-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: middle;
overflow-x: hidden;
}
#dzawjmqldw .gt_stub {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-right-style: solid;
border-right-width: 2px;
border-right-color: #D3D3D3;
padding-left: 5px;
padding-right: 5px;
}
#dzawjmqldw .gt_stub_row_group {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-right-style: solid;
border-right-width: 2px;
border-right-color: #D3D3D3;
padding-left: 5px;
padding-right: 5px;
vertical-align: top;
}
#dzawjmqldw .gt_row_group_first td {
border-top-width: 2px;
}
#dzawjmqldw .gt_row_group_first th {
border-top-width: 2px;
}
#dzawjmqldw .gt_summary_row {
color: #333333;
background-color: #FFFFFF;
text-transform: inherit;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
}
#dzawjmqldw .gt_first_summary_row {
border-top-style: solid;
border-top-color: #D3D3D3;
}
#dzawjmqldw .gt_first_summary_row.thick {
border-top-width: 2px;
}
#dzawjmqldw .gt_last_summary_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#dzawjmqldw .gt_grand_summary_row {
color: #333333;
background-color: #FFFFFF;
text-transform: inherit;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
}
#dzawjmqldw .gt_first_grand_summary_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-top-style: double;
border-top-width: 6px;
border-top-color: #D3D3D3;
}
#dzawjmqldw .gt_last_grand_summary_row_top {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-bottom-style: double;
border-bottom-width: 6px;
border-bottom-color: #D3D3D3;
}
#dzawjmqldw .gt_striped {
background-color: rgba(128, 128, 128, 0.05);
}
#dzawjmqldw .gt_table_body {
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#dzawjmqldw .gt_footnotes {
color: #333333;
background-color: #FFFFFF;
border-bottom-style: none;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
}
#dzawjmqldw .gt_footnote {
margin: 0px;
font-size: 90%;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
}
#dzawjmqldw .gt_sourcenotes {
color: #333333;
background-color: #FFFFFF;
border-bottom-style: none;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
}
#dzawjmqldw .gt_sourcenote {
font-size: 90%;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
}
#dzawjmqldw .gt_left {
text-align: left;
}
#dzawjmqldw .gt_center {
text-align: center;
}
#dzawjmqldw .gt_right {
text-align: right;
font-variant-numeric: tabular-nums;
}
#dzawjmqldw .gt_font_normal {
font-weight: normal;
}
#dzawjmqldw .gt_font_bold {
font-weight: bold;
}
#dzawjmqldw .gt_font_italic {
font-style: italic;
}
#dzawjmqldw .gt_super {
font-size: 65%;
}
#dzawjmqldw .gt_footnote_marks {
font-size: 75%;
vertical-align: 0.4em;
position: initial;
}
#dzawjmqldw .gt_asterisk {
font-size: 100%;
vertical-align: 0;
}
#dzawjmqldw .gt_indent_1 {
text-indent: 5px;
}
#dzawjmqldw .gt_indent_2 {
text-indent: 10px;
}
#dzawjmqldw .gt_indent_3 {
text-indent: 15px;
}
#dzawjmqldw .gt_indent_4 {
text-indent: 20px;
}
#dzawjmqldw .gt_indent_5 {
text-indent: 25px;
}
#dzawjmqldw .katex-display {
display: inline-flex !important;
margin-bottom: 0.75em !important;
}
#dzawjmqldw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Overview Each Simulation results</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Sim-ID">Sim ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Method">Method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Parameter">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Z">Z</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="SE">SE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="P-value">P value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Sim ID" class="gt_row gt_right">1</td>
<td headers="Method" class="gt_row gt_left">WLR</td>
<td headers="Parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="Z" class="gt_row gt_right">1.9005840</td>
<td headers="Estimate" class="gt_row gt_right">-18.1176359</td>
<td headers="SE" class="gt_row gt_right">9.5326679</td>
<td headers="P value" class="gt_row gt_right">0.02867826</td></tr>
    <tr><td headers="Sim ID" class="gt_row gt_right">1</td>
<td headers="Method" class="gt_row gt_left">WLR</td>
<td headers="Parameter" class="gt_row gt_left">FH(rho=0, gamma=0.5)</td>
<td headers="Z" class="gt_row gt_right">2.1478743</td>
<td headers="Estimate" class="gt_row gt_right">-12.7153128</td>
<td headers="SE" class="gt_row gt_right">5.9199519</td>
<td headers="P value" class="gt_row gt_right">0.01586187</td></tr>
    <tr><td headers="Sim ID" class="gt_row gt_right">1</td>
<td headers="Method" class="gt_row gt_left">WLR</td>
<td headers="Parameter" class="gt_row gt_left">MB(delay = Inf, max_weight = 2)</td>
<td headers="Z" class="gt_row gt_right">2.0945611</td>
<td headers="Estimate" class="gt_row gt_right">-32.4645715</td>
<td headers="SE" class="gt_row gt_right">15.4994626</td>
<td headers="P value" class="gt_row gt_right">0.01810501</td></tr>
    <tr><td headers="Sim ID" class="gt_row gt_right">1</td>
<td headers="Method" class="gt_row gt_left">WLR</td>
<td headers="Parameter" class="gt_row gt_left">Xu 2017 with first 3 months of 0 weights</td>
<td headers="Z" class="gt_row gt_right">1.9926533</td>
<td headers="Estimate" class="gt_row gt_right">-16.4165941</td>
<td headers="SE" class="gt_row gt_right">8.2385601</td>
<td headers="P value" class="gt_row gt_right">0.02314971</td></tr>
    <tr><td headers="Sim ID" class="gt_row gt_right">1</td>
<td headers="Method" class="gt_row gt_left">RMST</td>
<td headers="Parameter" class="gt_row gt_left">10</td>
<td headers="Z" class="gt_row gt_right">0.7072865</td>
<td headers="Estimate" class="gt_row gt_right">0.2184929</td>
<td headers="SE" class="gt_row gt_right">0.3089170</td>
<td headers="P value" class="gt_row gt_right">0.23969421</td></tr>
    <tr><td headers="Sim ID" class="gt_row gt_right">1</td>
<td headers="Method" class="gt_row gt_left">milestone</td>
<td headers="Parameter" class="gt_row gt_left">10</td>
<td headers="Z" class="gt_row gt_right">0.9610773</td>
<td headers="Estimate" class="gt_row gt_right">0.1280086</td>
<td headers="SE" class="gt_row gt_right">0.1331928</td>
<td headers="P value" class="gt_row gt_right">0.16825665</td></tr>
  </tbody>
  
</table>
</div>
</div>
<div id="step-5-summarize-simulations" class="section level1">
<h1>Step 5: Summarize simulations</h1>
<p>Using the 100 parallel simulations provided above, users can
summarize the simulated power and compare it across different testing
methods with some data manipulation using <code>dplyr</code>. Please
note that the power calculation for the MaxCombo test differs from the
other tests, as it does not report a Z-score.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>ans_non_mc <span class="ot">&lt;-</span> ans <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">filter</span>(Method <span class="sc">!=</span> <span class="st">&quot;MaxCombo&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Method, Parameter) <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Power =</span> <span class="fu">mean</span>(Z <span class="sc">&gt;</span> <span class="sc">-</span><span class="fu">qnorm</span>(<span class="fl">0.025</span>))) <span class="sc">|&gt;</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>ans_mc <span class="ot">&lt;-</span> ans <span class="sc">|&gt;</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  <span class="fu">filter</span>(Method <span class="sc">==</span> <span class="st">&quot;MaxCombo&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Power =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">P value</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="fl">0.025</span>), <span class="at">Method =</span> <span class="st">&quot;MaxCombo&quot;</span>, <span class="at">Parameter =</span> <span class="st">&quot;FH(0, 0) + FH(0, 0.5)&quot;</span>) </span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>ans_non_mc <span class="sc">|&gt;</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>  <span class="fu">union</span>(ans_mc) <span class="sc">|&gt;</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">&quot;Summary from 100 simulations&quot;</span>)</span></code></pre></div>
<div id="uwkneayvxc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uwkneayvxc table {
font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
}
#uwkneayvxc thead, #uwkneayvxc tbody, #uwkneayvxc tfoot, #uwkneayvxc tr, #uwkneayvxc td, #uwkneayvxc th {
border-style: none;
}
#uwkneayvxc p {
margin: 0;
padding: 0;
}
#uwkneayvxc .gt_table {
display: table;
border-collapse: collapse;
line-height: normal;
margin-left: auto;
margin-right: auto;
color: #333333;
font-size: 16px;
font-weight: normal;
font-style: normal;
background-color: #FFFFFF;
width: auto;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #A8A8A8;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #A8A8A8;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
}
#uwkneayvxc .gt_caption {
padding-top: 4px;
padding-bottom: 4px;
}
#uwkneayvxc .gt_title {
color: #333333;
font-size: 125%;
font-weight: initial;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
border-bottom-color: #FFFFFF;
border-bottom-width: 0;
}
#uwkneayvxc .gt_subtitle {
color: #333333;
font-size: 85%;
font-weight: initial;
padding-top: 3px;
padding-bottom: 5px;
padding-left: 5px;
padding-right: 5px;
border-top-color: #FFFFFF;
border-top-width: 0;
}
#uwkneayvxc .gt_heading {
background-color: #FFFFFF;
text-align: center;
border-bottom-color: #FFFFFF;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
}
#uwkneayvxc .gt_bottom_border {
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#uwkneayvxc .gt_col_headings {
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
}
#uwkneayvxc .gt_col_heading {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: normal;
text-transform: inherit;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: bottom;
padding-top: 5px;
padding-bottom: 6px;
padding-left: 5px;
padding-right: 5px;
overflow-x: hidden;
}
#uwkneayvxc .gt_column_spanner_outer {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: normal;
text-transform: inherit;
padding-top: 0;
padding-bottom: 0;
padding-left: 4px;
padding-right: 4px;
}
#uwkneayvxc .gt_column_spanner_outer:first-child {
padding-left: 0;
}
#uwkneayvxc .gt_column_spanner_outer:last-child {
padding-right: 0;
}
#uwkneayvxc .gt_column_spanner {
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
vertical-align: bottom;
padding-top: 5px;
padding-bottom: 5px;
overflow-x: hidden;
display: inline-block;
width: 100%;
}
#uwkneayvxc .gt_spanner_row {
border-bottom-style: hidden;
}
#uwkneayvxc .gt_group_heading {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: middle;
text-align: left;
}
#uwkneayvxc .gt_empty_group_heading {
padding: 0.5px;
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
vertical-align: middle;
}
#uwkneayvxc .gt_from_md > :first-child {
margin-top: 0;
}
#uwkneayvxc .gt_from_md > :last-child {
margin-bottom: 0;
}
#uwkneayvxc .gt_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
margin: 10px;
border-top-style: solid;
border-top-width: 1px;
border-top-color: #D3D3D3;
border-left-style: none;
border-left-width: 1px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 1px;
border-right-color: #D3D3D3;
vertical-align: middle;
overflow-x: hidden;
}
#uwkneayvxc .gt_stub {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-right-style: solid;
border-right-width: 2px;
border-right-color: #D3D3D3;
padding-left: 5px;
padding-right: 5px;
}
#uwkneayvxc .gt_stub_row_group {
color: #333333;
background-color: #FFFFFF;
font-size: 100%;
font-weight: initial;
text-transform: inherit;
border-right-style: solid;
border-right-width: 2px;
border-right-color: #D3D3D3;
padding-left: 5px;
padding-right: 5px;
vertical-align: top;
}
#uwkneayvxc .gt_row_group_first td {
border-top-width: 2px;
}
#uwkneayvxc .gt_row_group_first th {
border-top-width: 2px;
}
#uwkneayvxc .gt_summary_row {
color: #333333;
background-color: #FFFFFF;
text-transform: inherit;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
}
#uwkneayvxc .gt_first_summary_row {
border-top-style: solid;
border-top-color: #D3D3D3;
}
#uwkneayvxc .gt_first_summary_row.thick {
border-top-width: 2px;
}
#uwkneayvxc .gt_last_summary_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#uwkneayvxc .gt_grand_summary_row {
color: #333333;
background-color: #FFFFFF;
text-transform: inherit;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
}
#uwkneayvxc .gt_first_grand_summary_row {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-top-style: double;
border-top-width: 6px;
border-top-color: #D3D3D3;
}
#uwkneayvxc .gt_last_grand_summary_row_top {
padding-top: 8px;
padding-bottom: 8px;
padding-left: 5px;
padding-right: 5px;
border-bottom-style: double;
border-bottom-width: 6px;
border-bottom-color: #D3D3D3;
}
#uwkneayvxc .gt_striped {
background-color: rgba(128, 128, 128, 0.05);
}
#uwkneayvxc .gt_table_body {
border-top-style: solid;
border-top-width: 2px;
border-top-color: #D3D3D3;
border-bottom-style: solid;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
}
#uwkneayvxc .gt_footnotes {
color: #333333;
background-color: #FFFFFF;
border-bottom-style: none;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
}
#uwkneayvxc .gt_footnote {
margin: 0px;
font-size: 90%;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
}
#uwkneayvxc .gt_sourcenotes {
color: #333333;
background-color: #FFFFFF;
border-bottom-style: none;
border-bottom-width: 2px;
border-bottom-color: #D3D3D3;
border-left-style: none;
border-left-width: 2px;
border-left-color: #D3D3D3;
border-right-style: none;
border-right-width: 2px;
border-right-color: #D3D3D3;
}
#uwkneayvxc .gt_sourcenote {
font-size: 90%;
padding-top: 4px;
padding-bottom: 4px;
padding-left: 5px;
padding-right: 5px;
}
#uwkneayvxc .gt_left {
text-align: left;
}
#uwkneayvxc .gt_center {
text-align: center;
}
#uwkneayvxc .gt_right {
text-align: right;
font-variant-numeric: tabular-nums;
}
#uwkneayvxc .gt_font_normal {
font-weight: normal;
}
#uwkneayvxc .gt_font_bold {
font-weight: bold;
}
#uwkneayvxc .gt_font_italic {
font-style: italic;
}
#uwkneayvxc .gt_super {
font-size: 65%;
}
#uwkneayvxc .gt_footnote_marks {
font-size: 75%;
vertical-align: 0.4em;
position: initial;
}
#uwkneayvxc .gt_asterisk {
font-size: 100%;
vertical-align: 0;
}
#uwkneayvxc .gt_indent_1 {
text-indent: 5px;
}
#uwkneayvxc .gt_indent_2 {
text-indent: 10px;
}
#uwkneayvxc .gt_indent_3 {
text-indent: 15px;
}
#uwkneayvxc .gt_indent_4 {
text-indent: 20px;
}
#uwkneayvxc .gt_indent_5 {
text-indent: 25px;
}
#uwkneayvxc .katex-display {
display: inline-flex !important;
margin-bottom: 0.75em !important;
}
#uwkneayvxc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Summary from 100 simulations</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Method">Method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Parameter">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Power">Power</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Method" class="gt_row gt_left">RMST</td>
<td headers="Parameter" class="gt_row gt_left">10</td>
<td headers="Power" class="gt_row gt_right">0.06</td></tr>
    <tr><td headers="Method" class="gt_row gt_left">WLR</td>
<td headers="Parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="Power" class="gt_row gt_right">0.39</td></tr>
    <tr><td headers="Method" class="gt_row gt_left">WLR</td>
<td headers="Parameter" class="gt_row gt_left">FH(rho=0, gamma=0.5)</td>
<td headers="Power" class="gt_row gt_right">0.53</td></tr>
    <tr><td headers="Method" class="gt_row gt_left">WLR</td>
<td headers="Parameter" class="gt_row gt_left">MB(delay = Inf, max_weight = 2)</td>
<td headers="Power" class="gt_row gt_right">0.54</td></tr>
    <tr><td headers="Method" class="gt_row gt_left">WLR</td>
<td headers="Parameter" class="gt_row gt_left">Xu 2017 with first 3 months of 0 weights</td>
<td headers="Power" class="gt_row gt_right">0.48</td></tr>
    <tr><td headers="Method" class="gt_row gt_left">milestone</td>
<td headers="Parameter" class="gt_row gt_left">10</td>
<td headers="Power" class="gt_row gt_right">0.13</td></tr>
    <tr><td headers="Method" class="gt_row gt_left">MaxCombo</td>
<td headers="Parameter" class="gt_row gt_left">FH(0, 0) + FH(0, 0.5)</td>
<td headers="Power" class="gt_row gt_right">0.52</td></tr>
  </tbody>
  
</table>
</div>
<div id="references" class="section level2">
<h2>References</h2>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
